package com.miguelmartin.tuconsumo.model

import android.content.Context
import com.miguelmartin.tuconsumo.Entities.Coche
import com.miguelmartin.tuconsumo.Entities.Combustible
import com.miguelmartin.tuconsumo.Entities.Resultados
import com.miguelmartin.tuconsumo.Entities.Viaje
import com.miguelmartin.tuconsumo.Enums.TipoCombustible
import org.junit.Assert
import org.junit.Test
import org.junit.runner.RunWith
import androidx.test.core.app.ApplicationProvider
import org.robolectric.RobolectricTestRunner

@RunWith(RobolectricTestRunner::class)
class MainModelTest {

    val mainModel = MainModel()
    val context = ApplicationProvider.getApplicationContext<Context>()

    @Test
    fun calcularConsumoTest() {
        val combustible = Combustible(TipoCombustible.GASOLINA_95, 1.4F)
        val coche = Coche(null, 6.5, combustible)
        val viaje = Viaje(null, 30.0, 2, coche)
        Assert.assertTrue(mainModel.calcularConsumo(viaje) == Resultados(60.00, 3.90, 5.46))
    }
/*
    @Test
    fun llamadaRestTest(){
        Assert.assertTrue(mainModel.llamadaRest(context,"https://sedeaplicaciones.minetur.gob.es/ServiciosRESTCarburantes/PreciosCarburantes/EstacionesTerrestres/FiltroCCAA/13?Accept=application/json&Content-Type=application/json"))
    }
    */

    @Test
    fun parsearAGasolineraRestTest(){
//        mainModel.parsearAGasolineraRest("[{'C.P.':'28607','Dirección':'CTRA. LOCAL M-404 km 4,95','Horario':'L-D: 24H','Latitud':'40,239056','Localidad':'ALAMO (EL)','Longitud (WGS84)':'-3,995528','Margen':'N','Municipio':'Álamo (El)','Precio Biodiesel':null,'Precio Bioetanol':null,'Precio Gas Natural Comprimido':null,'Precio Gas Natural Licuado':null,'Precio Gases licuados del petróleo':null,'Precio Gasoleo A':'1,284','Precio Gasoleo B':null,'Precio Gasolina 95 Protección':'1,359','Precio Gasolina  98':'1,501','Precio Nuevo Gasoleo A':'1,374','Provincia':'MADRID','Remisión':'dm','Rótulo':'BP DUALEZ','Tipo Venta':'P','% BioEtanol':'0,0','% Éster metílico':'0,0','IDEESS':'3072','IDMunicipio':'4279','IDProvincia':'28','IDCCAA':'13'},{'C.P.':'28607','Dirección':'CTRA. LOCAL M-404 km 3,640','Horario':'L-D: 06:00-22:30','Latitud':'40,251528','Localidad':'ALAMO (EL)','Longitud (WGS84)':'-3,999083','Margen':'I','Municipio':'Álamo (El)','Precio Biodiesel':null,'Precio Bioetanol':null,'Precio Gas Natural Comprimido':null,'Precio Gas Natural Licuado':null,'Precio Gases licuados del petróleo':null,'Precio Gasoleo A':'1,199','Precio Gasoleo B':null,'Precio Gasolina 95 Protección':'1,279','Precio Gasolina  98':null,'Precio Nuevo Gasoleo A':null,'Provincia':'MADRID','Remisión':'dm','Rótulo':'E.S. EL ALAMO, S.L.','Tipo Venta':'P','% BioEtanol':'0,0','% Éster metílico':'0,0','IDEESS':'8009','IDMunicipio':'4279','IDProvincia':'28','IDCCAA':'13'},{'C.P.':'28801','Dirección':'CALLE MEJICO, 17','Horario':'L-D: 24H','Latitud':'40,498250','Localidad':'ALCALA DE HENARES','Longitud (WGS84)':'-3,390139','Margen':'D','Municipio':'Alcalá de Henares','Precio Biodiesel':null,'Precio Bioetanol':null,'Precio Gas Natural Comprimido':null,'Precio Gas Natural Licuado':null,'Precio Gases licuados del petróleo':'0,729','Precio Gasoleo A':'1,199','Precio Gasoleo B':null,'Precio Gasolina 95 Protección':'1,289','Precio Gasolina  98':null,'Precio Nuevo Gasoleo A':'1,219','Provincia':'MADRID','Remisión':'dm','Rótulo':'AVIA','Tipo Venta':'P','% BioEtanol':'0,0','% Éster metílico':'0,0','IDEESS':'13592','IDMunicipio':'4280','IDProvincia':'28','IDCCAA':'13'}]")

        mainModel.getMediasCombustibles("{\"Fecha\":\"14\\/12\\/2019 14:34:50\",\"ListaEESSPrecio\":[{\"C.P.\":\"28864\",\"Dirección\":\"CARRETERA M-114 KM. 1\",\"Horario\":\"L-V: 07:00-20:00; S: 09:00-15:00\",\"Latitud\":\"40,526722\",\"Localidad\":\"AJALVIR\",\"Longitud (WGS84)\":\"-3,481556\",\"Margen\":\"D\",\"Municipio\":\"Ajalvir\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,269\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,359\",\"Precio Gasolina  98\":\"1,499\",\"Precio Nuevo Gasoleo A\":\"1,349\",\"Provincia\":\"MADRID\",\"Remisión\":\"OM\",\"Rótulo\":\"REPSOL\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"3118\",\"IDMunicipio\":\"4277\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28607\",\"Dirección\":\"CTRA. LOCAL M-404 km 4,95\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,239056\",\"Localidad\":\"ALAMO (EL)\",\"Longitud (WGS84)\":\"-3,995528\",\"Margen\":\"N\",\"Municipio\":\"Álamo (El)\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,284\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,359\",\"Precio Gasolina  98\":\"1,501\",\"Precio Nuevo Gasoleo A\":\"1,374\",\"Provincia\":\"MADRID\",\"Remisión\":\"dm\",\"Rótulo\":\"BP DUALEZ\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"3072\",\"IDMunicipio\":\"4279\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28607\",\"Dirección\":\"CTRA. LOCAL M-404 km 3,640\",\"Horario\":\"L-D: 06:00-22:30\",\"Latitud\":\"40,251528\",\"Localidad\":\"ALAMO (EL)\",\"Longitud (WGS84)\":\"-3,999083\",\"Margen\":\"I\",\"Municipio\":\"Álamo (El)\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,199\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,279\",\"Precio Gasolina  98\":null,\"Precio Nuevo Gasoleo A\":null,\"Provincia\":\"MADRID\",\"Remisión\":\"dm\",\"Rótulo\":\"E.S. EL ALAMO, S.L.\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"8009\",\"IDMunicipio\":\"4279\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28801\",\"Dirección\":\"CALLE MEJICO, 17\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,498250\",\"Localidad\":\"ALCALA DE HENARES\",\"Longitud (WGS84)\":\"-3,390139\",\"Margen\":\"D\",\"Municipio\":\"Alcalá de Henares\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":\"0,729\",\"Precio Gasoleo A\":\"1,199\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,289\",\"Precio Gasolina  98\":null,\"Precio Nuevo Gasoleo A\":\"1,219\",\"Provincia\":\"MADRID\",\"Remisión\":\"dm\",\"Rótulo\":\"AVIA\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"13592\",\"IDMunicipio\":\"4280\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28801\",\"Dirección\":\"CARRETERA DAGANZO KM. 3\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,492861\",\"Localidad\":\"ALCALA DE HENARES\",\"Longitud (WGS84)\":\"-3,381167\",\"Margen\":\"D\",\"Municipio\":\"Alcalá de Henares\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,067\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,167\",\"Precio Gasolina  98\":null,\"Precio Nuevo Gasoleo A\":null,\"Provincia\":\"MADRID\",\"Remisión\":\"dm\",\"Rótulo\":\"GASEXPRESS\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"14075\",\"IDMunicipio\":\"4280\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28802\",\"Dirección\":\"AVDA. PUERTA DE MADRID, 20\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,480750\",\"Localidad\":\"ALCALA DE HENARES\",\"Longitud (WGS84)\":\"-3,374889\",\"Margen\":\"N\",\"Municipio\":\"Alcalá de Henares\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,299\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,369\",\"Precio Gasolina  98\":\"1,494\",\"Precio Nuevo Gasoleo A\":\"1,367\",\"Provincia\":\"MADRID\",\"Remisión\":\"OM\",\"Rótulo\":\"SHELL\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"4716\",\"IDMunicipio\":\"4280\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28806\",\"Dirección\":\"CARRETERA AJARVIL-ALCALA (PG 32C PARCELA26A) KM. S\\/N\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,490361\",\"Localidad\":\"ALCALA DE HENARES\",\"Longitud (WGS84)\":\"-3,384778\",\"Margen\":\"N\",\"Municipio\":\"Alcalá de Henares\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":\"0,719\",\"Precio Gasoleo A\":\"1,299\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,369\",\"Precio Gasolina  98\":\"1,509\",\"Precio Nuevo Gasoleo A\":\"1,379\",\"Provincia\":\"MADRID\",\"Remisión\":\"OM\",\"Rótulo\":\"SHELL\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"8442\",\"IDMunicipio\":\"4280\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28806\",\"Dirección\":\"CALLE VILLAMALEA, 2\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,507750\",\"Localidad\":\"ALCALA DE HENARES\",\"Longitud (WGS84)\":\"-3,352722\",\"Margen\":\"N\",\"Municipio\":\"Alcalá de Henares\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,304\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,384\",\"Precio Gasolina  98\":\"1,494\",\"Precio Nuevo Gasoleo A\":\"1,374\",\"Provincia\":\"MADRID\",\"Remisión\":\"OM\",\"Rótulo\":\"GALP\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"3067\",\"IDMunicipio\":\"4280\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28230\",\"Dirección\":\"CL LAS CRUCES  S\\/N\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,489944\",\"Localidad\":\"ROZAS DE MADRID (LAS)\",\"Longitud (WGS84)\":\"-3,874194\",\"Margen\":\"N\",\"Municipio\":\"Rozas de Madrid (Las)\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,289\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,379\",\"Precio Gasolina  98\":\"1,521\",\"Precio Nuevo Gasoleo A\":\"1,379\",\"Provincia\":\"MADRID\",\"Remisión\":\"OM\",\"Rótulo\":\"BP LAS ROZAS\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"4316\",\"IDMunicipio\":\"4399\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28830\",\"Dirección\":\"CR N-2, 16,3\",\"Horario\":\"L-D: 24H\",\"Latitud\":\"40,449000\",\"Localidad\":\"SAN FERNANDO DE HENARES\",\"Longitud (WGS84)\":\"-3,522417\",\"Margen\":\"D\",\"Municipio\":\"San Fernando de Henares\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,309\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,369\",\"Precio Gasolina  98\":\"1,509\",\"Precio Nuevo Gasoleo A\":\"1,389\",\"Provincia\":\"MADRID\",\"Remisión\":\"OM\",\"Rótulo\":\"REPSOL\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"4580\",\"IDMunicipio\":\"4402\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"},{\"C.P.\":\"28670\",\"Dirección\":\"POLIGONO INDUSRIAL PINARES LLANOS, C\\/CARPINTEROS, S\\/N\",\"Horario\":\"L-D: 06:00-23:59\",\"Latitud\":\"40,350556\",\"Localidad\":\"VILLAVICIOSA DE ODON\",\"Longitud (WGS84)\":\"-3,904056\",\"Margen\":\"D\",\"Municipio\":\"Villaviciosa de Odón\",\"Precio Biodiesel\":null,\"Precio Bioetanol\":null,\"Precio Gas Natural Comprimido\":null,\"Precio Gas Natural Licuado\":null,\"Precio Gases licuados del petróleo\":null,\"Precio Gasoleo A\":\"1,279\",\"Precio Gasoleo B\":null,\"Precio Gasolina 95 Protección\":\"1,349\",\"Precio Gasolina  98\":\"1,464\",\"Precio Nuevo Gasoleo A\":\"1,339\",\"Provincia\":\"MADRID\",\"Remisión\":\"OM\",\"Rótulo\":\"CEPSA\",\"Tipo Venta\":\"P\",\"% BioEtanol\":\"0,0\",\"% Éster metílico\":\"0,0\",\"IDEESS\":\"3138\",\"IDMunicipio\":\"4452\",\"IDProvincia\":\"28\",\"IDCCAA\":\"13\"}],\"Nota\":\"Archivo de todos los productos en todas las estaciones de servicio. La actualización de precios se realiza cada media hora, con los precios en vigor en ese momento.\",\"ResultadoConsulta\":\"OK\"}")
    }
}